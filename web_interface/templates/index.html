<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Room Tracking</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        img {
            max-width: 100%;
            max-height: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .form-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 20px; /* Add margin for spacing */
        }

        form {
            text-align: center; /* Center form elements */
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Hospital Room Tracking</h1>
    </div>
    
    <!-- Use a dynamic image source based on whether the form has been submitted -->
    <img id="trackingImage" src="{{ url_for('static', filename='RoomMap.drawio.png') }}" width="600" height="600" />

    <div class="form-container">
        <script>
            var submitted = {{ submitted | tojson | safe }};

            function validateForm() {
                var xPoint = document.getElementById("Xpoint").value;
                var yPoint = document.getElementById("Ypoint").value;
            
                if (xPoint < 0 || xPoint > 600 || yPoint < 0 || yPoint > 600) {
                    alert("Coordinates must be between 0 and 600.");
                    return false;
                }
                return true;
            }

            // Function to update the image source after form submission
            function updateImageSource() 
            {
                var imageElement = document.getElementById("trackingImage");
                imageElement.src = "{{ url_for('img_feed') }}" + "?timestamp=" + new Date().getTime(); // Thêm timestamp để tránh cache

            // Gọi hàm khi trang web được tải
            window.onload = function () {
                // Cập nhật nguồn ảnh nếu đã submit
                if (submitted) {
                    updateImageSource();
                }
            };
            }
        </script>
          
        <h2>Input your destination coordinate</h2>
          
        <form action="{{ url_for('submit_destination') }}" method="post" onsubmit="return validateForm()">
            <label for="room">Select a Room:</label>
            <select id="room" name="room">
                <option value="401">401</option>
                <option value="402">402</option>
                <option value="403">403</option>
                <option value="404">404</option>
                <option value="405">405</option>
                <option value="406">406</option>

                <!-- Thêm các phòng khác vào đây -->
            </select><br><br>
          
            <input type="submit" value="Submit">
        </form>
    </div>
</body>
</html>
